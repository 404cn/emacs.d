#+begin_src elisp
  (use-package doom-modeline
    :straight t
    :hook ((after-init . doom-modeline-mode))
    :init (gsetq
           doom-modeline-height                   25
           doom-modeline-bar-width                3
           doom-modeline-buffer-file-name-style   'relative-from-project
           doom-modeline-icon                     t
           doom-modeline-major-mode-icon          t
           doom-modeline-major-mode-color-icon    t
           doom-modeline-buffer-state-icon        t
           doom-modeline-buffer-modification-icon t
           doom-modeline-minor-modes              t
           doom-modeline-enable-word-count        t
           doom-modeline-checker-simple-format    nil
           doom-modeline-vcs-max-length           12
           doom-modeline-persp-name               t
           doom-modeline-lsp                      t
           doom-modeline-github                   t
           doom-modeline-github-interval          (* 30 60)

           doom-modeline-env-version       t
           doom-modeline-env-enable-python t
           doom-modeline-env-enable-ruby   t
           doom-modeline-env-enable-perl   t
           doom-modeline-env-enable-go     t
           doom-modeline-env-enable-elixir t
           doom-modeline-env-enable-rust   t

           doom-modeline-env-python-executable "python"
           doom-modeline-env-ruby-executable   "ruby"
           doom-modeline-env-perl-executable   "perl"
           doom-modeline-env-go-executable     "go"
           doom-modeline-env-elixir-executable "iex"
           doom-modeline-env-rust-executable   "rustc"

           doom-modeline-mu4e        t
           doom-modeline-irc         t
           doom-modeline-irc-stylize 'identity)
    :config
    (doom-modeline-def-segment nasy/time
      "Time"
      (when (doom-modeline--active)
        (propertize
         (format-time-string " %b %d, %Y - %H:%M ")
         'face (when (doom-modeline--active) `(:foreground "#1b335f" :background "#fab95b")))))

    ;; Remove
    ;; modals (evil, god, ryo and xah-fly-keys, etc.), parrot
    ;; buffer-encoding
    ;; Add
    ;; nasy/time
    (doom-modeline-def-modeline 'main
      '(bar workspace-name window-number matches buffer-info remote-host buffer-position selection-info)
      '(misc-info persp-name lsp irc mu4e github debug battery minor-modes input-method major-mode process vcs checker " " process nasy/time))

    (doom-modeline-def-modeline 'minimal
      '(bar matches " " buffer-info)
      '(media-info major-mode " " nasy/time))

    (doom-modeline-def-modeline 'special
      '(bar window-number matches buffer-position selection-info)
      '(misc-info lsp irc-buffers debug battery minor-modes input-method major-mode process nasy/time))

    (doom-modeline-def-modeline 'media
      '(bar window-number buffer-size buffer-info)
      '(misc-info media-info major-mode process vcs " " nasy/time))

    (doom-modeline-def-modeline 'pdf
      '(bar window-number buffer-size buffer-info pdf-pages)
      '(misc-info " " major-mode process vcs " " nasy/time))

    (doom-modeline-def-modeline 'project
      '(bar window-number " " buffer-default-directory)
      '(misc-info mu4e github debug battery " " major-mode " " process nasy/time))

    ;; Change behaviors
    (defun nasy/doom-modeline-update-buffer-file-name (&rest _)
      "Update buffer file name in mode-line."
      (setq doom-modeline--buffer-file-name
            (if buffer-file-name
                (doom-modeline-buffer-file-name)
              (if (string-prefix-p "*Org Src" (format-mode-line "%b"))
                  ""
                (propertize "%b"
                            'face (if (doom-modeline--active)
                                      'doom-modeline-buffer-file
                                    'mode-line-inactive)
                            'help-echo "Buffer name
      mouse-1: Previous buffer\nmouse-3: Next buffer"
                            'local-map mode-line-buffer-identification-keymap)))))
    (advice-add #'doom-modeline-update-buffer-file-name :override #'nasy/doom-modeline-update-buffer-file-name))

#+end_src
